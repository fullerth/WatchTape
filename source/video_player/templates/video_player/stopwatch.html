{% extends "base_site.html" %}

{% block title %}Stopwatch{% endblock title %}

{% block head_block %}

<script type="text/javascript">
{% if times %}
timing_data = {{ times }}
{% else %}
timing_data = [90, 100, 150];
{% endif %}
</script>

<script src="{{ STATIC_URL }}video_player/video_player.js" type="text/javascript"></script>

<script src="http://a.vimeocdn.com/js/froogaloop2.min.js"></script>

<script src="{{ STATIC_URL }}video_player/video_player_api.js" type="text/javascript"></script>




{% endblock head_block %}



{% block content_block %}

    </body>


    <div class="container">
        
        <div id="video_player" class="embed-responsive embed-responsive-16by9">
            <iframe id="vimeo_player" src="{{ video.player_url }}?api=1&player_id=vimeo_player"
            width="500" height="281" frameborder="0" class="embed-responsive-item">
            </iframe>
        </div>
        
        <!-- Nav Tabs -->
        <div id="jam_info_tabs">
            <ul class="nav nav-tabs" role="tablist">
                <li class="active"><a href="#players" role="tab" data-toggle="tab">
                    Players</a></li>
                <li class=""><a href="#filters" role="tab" data-toggle="tab">
                    Filters</a></li>
            </ul>
        </div>

        <div id="myTabContent" class="tab-content">
            <div class="tab-pane active" id="timer">

                {% include "video_player/timer.html" %}


                <!-- Controls
                <a class="left carousel-control" href="#jam_carousel" role="button"
                data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                </a>
                <a class="right carousel-control" href="#jam_carousel" role="button"
                data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                </a> -->
            </div>
            </div>
            <div class="tab-pane" id="filters">This is where you'll be able to
            tick some boxes and filter the jams that will be shown by player</div>
        </div>

    </div>
{% endblock content_block %}

{% block jquery_plugin_includes %}
<script src="{{ STATIC_URL }}video_player/jquery_cookie.js" type="text/javascript"></script>
{% endblock jquery_plugin_includes %}

{% block local_script_includes %}

<script>
function markCurrentVideoTime()
{
    console.log("Called Current Video Time")
}

$(document).ready(function() {
    var jam_time_button = document.getElementById('id_jam_time_button')

    if(jam_time_button) {
        jam_time_button.onclick = function() {
            var myCookie = $.cookie('csrftoken')

            console.log(myCookie)
            VideoPlayer.froogaloop.api('getCurrentTime', function (value, player_id) {
                console.log("Current Video Time :" + value)
            })
            

            retVal = $.post('/watchtape/videotojam/', {"jam": 54,
                                                       "start_time": "0h1m10s",
                                                       "end_time": "0h4m40s",
                                                       "video": 1
                                                       })
            console.log(retVal)
        }
    }
});

function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}

$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            var csrfCookie = $.cookie('csrftoken')
            xhr.setRequestHeader("X-CSRFToken", csrfCookie);
        }
    }
});
</script>
{% endblock local_script_includes %}